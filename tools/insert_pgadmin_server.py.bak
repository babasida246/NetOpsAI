import sqlite3

DB = '/var/lib/pgadmin/pgadmin4.db'
conn = sqlite3.connect(DB)
cur = conn.cursor()
# Check if server already exists
cur.execute("SELECT id, name, host, port FROM server WHERE host = 'postgres' LIMIT 1")
row = cur.fetchone()
if row:
    print('Server already exists:', row)
else:
    # Insert into server
    cur.execute("INSERT INTO server (user_id, servergroup_id, name, host, port, maintenance_db, username, comment, save_password, shared) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)", (1, 1, 'Hospital Gateway - PostgreSQL', 'postgres', 5432, 'hospital_gateway', 'postgres', 'Auto-configured connection to Hospital Gateway database', 0, 0))
    conn.commit()
    print('Inserted server id:', cur.lastrowid)

# Show server rows
cur.execute("SELECT id, name, host, port, username FROM server")
for r in cur.fetchall():
    print(r)

conn.close()
